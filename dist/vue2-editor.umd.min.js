/*!
 * vue2-editor v2.9.0-next.1 
 * (c) 2019 David Royer
 * Released under the MIT License.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("quill")):"function"==typeof define&&define.amd?define(["exports","quill"],e):(t=t||self,e(t.Vue2Editor={},t.Quill))}(this,function(t,e){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?s(t):e}function d(t,e){return f(t)||h(t,e)||m()}function f(t){if(Array.isArray(t))return t}function h(t,e){var n=[],i=!0,o=!1,r=void 0;try{for(var l,a=t[Symbol.iterator]();!(i=(l=a.next()).done)&&(n.push(l.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}function m(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function p(t,e){var i=function(t){return t&&"object"===n(t)};return i(t)&&i(e)?(Object.keys(e).forEach(function(n){var o=t[n],r=e[n];Array.isArray(o)&&Array.isArray(r)?t[n]=o.concat(r):i(o)&&i(r)?t[n]=p(Object.assign({},o),r):t[n]=r}),t):e}function g(t,e,n,i,o,r,l,a,u,s){"boolean"!=typeof l&&(u=a,a=l,l=!1);var c="function"==typeof n?n.options:n;t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,o&&(c.functional=!0)),i&&(c._scopeId=i);var d;if(r?(d=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,u(t)),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=d):e&&(d=l?function(){e.call(this,s(this.$root.$options.shadowRoot))}:function(t){e.call(this,a(t))}),d)if(c.functional){var f=c.render;c.render=function(t,e){return d.call(e),f(t,e)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,d):[d]}return n}function y(t){y.installed||(y.installed=!0,t.component("VueEditor",w))}e=e&&e.hasOwnProperty("default")?e.default:e;var v=[[{header:[!1,1,2,3,4,5,6]}],["bold","italic","underline","strike"],[{align:""},{align:"center"},{align:"right"},{align:"justify"}],["blockquote","code-block"],[{list:"ordered"},{list:"bullet"},{list:"check"}],[{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],["link","image","video"],["clean"]],b={props:{customModules:Array},methods:{registerCustomModules:function(t){void 0!==this.customModules&&this.customModules.forEach(function(e){t.register("modules/"+e.alias,e.module)})}}},q=e.import("blots/block/embed"),x=function(t){function e(){return i(this,e),c(this,a(e).apply(this,arguments))}return l(e,t),e}(q);x.blotName="hr",x.tagName="hr",e.register("formats/horizontal",x);var T=function(){function t(n,o){var r=this;i(this,t),this.quill=n,this.options=o,this.ignoreTags=["PRE"],this.matches=[{name:"header",pattern:/^(#){1,6}\s/g,action:function(t,e,n){var i=n.exec(t);if(i){var o=i[0].length;setTimeout(function(){r.quill.formatLine(e.index,0,"header",o-1),r.quill.deleteText(e.index-o,o)},0)}}},{name:"blockquote",pattern:/^(>)\s/g,action:function(t,e){setTimeout(function(){r.quill.formatLine(e.index,1,"blockquote",!0),r.quill.deleteText(e.index-2,2)},0)}},{name:"code-block",pattern:/^`{3}(?:\s|\n)/g,action:function(t,e){setTimeout(function(){r.quill.formatLine(e.index,1,"code-block",!0),r.quill.deleteText(e.index-4,4)},0)}},{name:"bolditalic",pattern:/(?:\*|_){3}(.+?)(?:\*|_){3}/g,action:function(t,e,n,i){var o=n.exec(t),l=o[0],a=o[1],u=i+o.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(u,l.length),r.quill.insertText(u,a,{bold:!0,italic:!0}),r.quill.format("bold",!1)},0)}},{name:"bold",pattern:/(?:\*|_){2}(.+?)(?:\*|_){2}/g,action:function(t,e,n,i){var o=n.exec(t),l=o[0],a=o[1],u=i+o.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(u,l.length),r.quill.insertText(u,a,{bold:!0}),r.quill.format("bold",!1)},0)}},{name:"italic",pattern:/(?:\*|_){1}(.+?)(?:\*|_){1}/g,action:function(t,e,n,i){var o=n.exec(t),l=o[0],a=o[1],u=i+o.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(u,l.length),r.quill.insertText(u,a,{italic:!0}),r.quill.format("italic",!1)},0)}},{name:"strikethrough",pattern:/(?:~~)(.+?)(?:~~)/g,action:function(t,e,n,i){var o=n.exec(t),l=o[0],a=o[1],u=i+o.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(u,l.length),r.quill.insertText(u,a,{strike:!0}),r.quill.format("strike",!1)},0)}},{name:"code",pattern:/(?:`)(.+?)(?:`)/g,action:function(t,e,n,i){var o=n.exec(t),l=o[0],a=o[1],u=i+o.index;t.match(/^([*_ \n]+)$/g)||setTimeout(function(){r.quill.deleteText(u,l.length),r.quill.insertText(u,a,{code:!0}),r.quill.format("code",!1),r.quill.insertText(r.quill.getSelection()," ")},0)}},{name:"hr",pattern:/^([-*]\s?){3}/g,action:function(t,n){var i=n.index-t.length;setTimeout(function(){r.quill.deleteText(i,t.length),r.quill.insertEmbed(i+1,"hr",!0,e.sources.USER),r.quill.insertText(i+2,"\n",e.sources.SILENT),r.quill.setSelection(i+2,e.sources.SILENT)},0)}},{name:"asterisk-ul",pattern:/^(\*|\+)\s$/g,action:function(t,e,n){setTimeout(function(){r.quill.formatLine(e.index,1,"list","unordered"),r.quill.deleteText(e.index-2,2)},0)}},{name:"image",pattern:/(?:!\[(.+?)\])(?:\((.+?)\))/g,action:function(t,e,n){var i=t.search(n),o=t.match(n)[0],l=t.match(/(?:\((.*?)\))/g)[0],a=e.index-o.length-1;-1!==i&&setTimeout(function(){r.quill.deleteText(a,o.length),r.quill.insertEmbed(a,"image",l.slice(1,l.length-1))},0)}},{name:"link",pattern:/(?:\[(.+?)\])(?:\((.+?)\))/g,action:function(t,e,n){var i=t.search(n),o=t.match(n)[0],l=t.match(/(?:\[(.*?)\])/g)[0],a=t.match(/(?:\((.*?)\))/g)[0],u=e.index-o.length-1;-1!==i&&setTimeout(function(){r.quill.deleteText(u,o.length),r.quill.insertText(u,l.slice(1,l.length-1),"link",a.slice(1,a.length-1))},0)}}],this.quill.on("text-change",function(t,e,n){for(var i=0;i<t.ops.length;i++)t.ops[i].hasOwnProperty("insert")&&(" "===t.ops[i].insert?r.onSpace():"\n"===t.ops[i].insert&&r.onEnter())})}return r(t,[{key:"isValid",value:function(t,e){return void 0!==t&&t&&-1===this.ignoreTags.indexOf(e)}},{key:"onSpace",value:function(){var t=this.quill.getSelection();if(t){var e=this.quill.getLine(t.index),n=d(e,2),i=n[0],o=n[1],r=i.domNode.textContent,l=t.index-o;if(this.isValid(r,i.domNode.tagName)){var a=!0,u=!1,s=void 0;try{for(var c,f=this.matches[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var h=c.value;if(r.match(h.pattern))return console.log("matched:",h.name,r),void h.action(r,t,h.pattern,l)}}catch(t){u=!0,s=t}finally{try{a||null==f.return||f.return()}finally{if(u)throw s}}}}}},{key:"onEnter",value:function(){var t=this.quill.getSelection();if(t){var e=this.quill.getLine(t.index),n=d(e,2),i=n[0],o=n[1],r=i.domNode.textContent+" ",l=t.index-o;if(t.length=t.index++,this.isValid(r,i.domNode.tagName)){var a=!0,u=!1,s=void 0;try{for(var c,f=this.matches[Symbol.iterator]();!(a=(c=f.next()).done);a=!0){var h=c.value;if(r.match(h.pattern))return console.log("matched",h.name,r),void h.action(r,t,h.pattern,l)}}catch(t){u=!0,s=t}finally{try{a||null==f.return||f.return()}finally{if(u)throw s}}}}}}]),t}(),_={name:"VueEditor",mixins:[b],props:{id:{type:String,default:"quill-container"},placeholder:{type:String,default:""},value:{type:String,default:""},disabled:{type:Boolean},editorToolbar:{type:Array,default:function(){return[]}},editorOptions:{type:Object,required:!1,default:function(){return{}}},useCustomImageHandler:{type:Boolean,default:!1},useMarkdownShortcuts:{type:Boolean,default:!1}},data:function(){return{quill:null}},watch:{value:function(t){t==this.quill.root.innerHTML||this.quill.hasFocus()||(this.quill.root.innerHTML=t)},disabled:function(t){this.quill.enable(!t)}},mounted:function(){this.registerCustomModules(e),this.registerPrototypes(),this.initializeEditor()},beforeDestroy:function(){this.quill=null,delete this.quill},methods:{initializeEditor:function(){this.setupQuillEditor(),this.checkForCustomImageHandler(),this.handleInitialContent(),this.registerEditorEventListeners(),this.$emit("ready",this.quill)},setupQuillEditor:function(){var t={debug:!1,modules:this.setModules(),theme:"snow",placeholder:this.placeholder?this.placeholder:"",readOnly:!!this.disabled&&this.disabled};this.prepareEditorConfig(t),this.quill=new e(this.$refs.quillContainer,t)},setModules:function(){var t={toolbar:this.editorToolbar.length?this.editorToolbar:v};return this.useMarkdownShortcuts&&(e.register("modules/markdownShortcuts",T,!0),t.markdownShortcuts={}),t},prepareEditorConfig:function(t){Object.keys(this.editorOptions).length>0&&this.editorOptions.constructor===Object&&(this.editorOptions.modules&&void 0!==this.editorOptions.modules.toolbar&&delete t.modules.toolbar,p(t,this.editorOptions))},registerPrototypes:function(){e.prototype.getHTML=function(){return this.container.querySelector(".ql-editor").innerHTML},e.prototype.getWordCount=function(){return this.container.querySelector(".ql-editor").innerText.length}},registerEditorEventListeners:function(){this.quill.on("text-change",this.handleTextChange),this.quill.on("selection-change",this.handleSelectionChange),this.listenForEditorEvent("text-change"),this.listenForEditorEvent("selection-change"),this.listenForEditorEvent("editor-change")},listenForEditorEvent:function(t){var e=this;this.quill.on(t,function(){for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];e.$emit.apply(e,[t].concat(i))})},handleInitialContent:function(){this.value&&(this.quill.root.innerHTML=this.value)},handleSelectionChange:function(t,e){!t&&e?this.$emit("blur",this.quill):t&&!e&&this.$emit("focus",this.quill)},handleTextChange:function(){var t="<p><br></p>"===this.quill.getHTML()?"":this.quill.getHTML();this.$emit("input",t)},checkForCustomImageHandler:function(){!0===this.useCustomImageHandler&&this.setupCustomImageHandler()},setupCustomImageHandler:function(){this.quill.getModule("toolbar").addHandler("image",this.customImageHandler)},customImageHandler:function(t,e){this.$refs.fileInput.click()},emitImageInfo:function(t){var e=function(){document.getElementById("file-upload").value=""},n=t.target.files[0],i=this.quill,o=i.getSelection(),r=o.index;this.$emit("imageAdded",n,i,r,e)}}},E=g;const S=_;var C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"quillWrapper"},[t._t("toolbar"),t._v(" "),n("div",{ref:"quillContainer",attrs:{id:t.id}}),t._v(" "),t.useCustomImageHandler?n("input",{ref:"fileInput",staticStyle:{display:"none"},attrs:{id:"file-upload",type:"file",accept:"image/*"},on:{change:function(e){return t.emitImageInfo(e)}}}):t._e()],2)},k=[];var w=E({render:C,staticRenderFns:k},void 0,S,void 0,!1,void 0,void 0,void 0),O={install:y,version:"2.9.0-next.1",Quill:e,VueEditor:w},I=null;"undefined"!=typeof window?I=window.Vue:"undefined"!=typeof global&&(I=global.Vue),I&&I.use(O),t.Quill=e,t.VueEditor=w,t.default=O,t.install=y,Object.defineProperty(t,"__esModule",{value:!0})});